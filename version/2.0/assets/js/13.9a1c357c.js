(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{409:function(e,t,a){"use strict";a.r(t);var i=a(42),r=Object(i.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("p",[e._v("The configuration API, accessible by only super-admin requests, is used to define dynamic configurations. Dynamic configuration is needed in situations like")]),e._v(" "),a("ul",[a("li",[e._v("RSA key pair generated automatically at boot time if not present")]),e._v(" "),a("li",[e._v("service-specific subscription confirmation request message template")])]),e._v(" "),a("h2",{attrs:{id:"model-schema"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#model-schema"}},[e._v("#")]),e._v(" Model Schema")]),e._v(" "),a("p",[e._v("The API operates on following configuration data model fields:")]),e._v(" "),a("table",[a("tr",[a("th",[e._v("Name")]),e._v(" "),a("th",[e._v("Attributes")])]),e._v(" "),a("tr",[a("td",[a("p",{staticClass:"name"},[e._v("id")]),e._v(" "),a("p",{staticClass:"description"},[e._v("config id")])]),e._v(" "),a("td",[a("table",[a("tr",[a("td",[e._v("type")]),a("td",[e._v("string, format depends on db")])]),e._v(" "),a("tr",[a("td",[e._v("auto-generated")]),a("td",[e._v("true")])])])])]),e._v(" "),a("tr",[a("td",[a("p",{staticClass:"name"},[e._v("name")]),e._v(" "),a("p",{staticClass:"description"},[e._v("config name")])]),e._v(" "),a("td",[a("table",[a("tr",[a("td",[e._v("type")]),a("td",[e._v("string")])]),e._v(" "),a("tr",[a("td",[e._v("required")]),a("td",[e._v("true")])])])])]),e._v(" "),a("tr",[a("td",[a("p",{staticClass:"name"},[e._v("value")]),e._v(" "),a("div",{staticClass:"description"},[e._v("config value.\n      ")])]),e._v(" "),a("td",[a("table",[a("tr",[a("td",[e._v("type")]),a("td",[e._v("object")])]),e._v(" "),a("tr",[a("td",[e._v("required")]),a("td",[e._v("true")])])])])]),e._v(" "),a("tr",[a("td",[a("p",{staticClass:"name"},[e._v("serviceName")]),e._v(" "),a("p",{staticClass:"description"},[e._v("name of the service the config applicable to")])]),e._v(" "),a("td",[a("table",[a("tr",[a("td",[e._v("type")]),a("td",[e._v("string")])]),e._v(" "),a("tr",[a("td",[e._v("required")]),a("td",[e._v("false")])])])])])]),e._v(" "),a("h2",{attrs:{id:"get-configurations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-configurations"}},[e._v("#")]),e._v(" Get Configurations")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("GET /configurations\n")])])]),a("ul",[a("li",[a("p",[e._v("permissions required, one of")]),e._v(" "),a("ul",[a("li",[e._v("super admin")]),e._v(" "),a("li",[e._v("admin")])])]),e._v(" "),a("li",[a("p",[e._v("inputs")]),e._v(" "),a("ul",[a("li",[e._v("a "),a("a",{attrs:{href:"https://loopback.io/doc/en/lb4/Querying-data.html#filters",target:"_blank",rel:"noopener noreferrer"}},[e._v("filter"),a("OutboundLink")],1),e._v(" defining fields, where, include, order, offset, and limit\n"),a("ul",[a("li",[e._v("parameter name: filter")]),e._v(" "),a("li",[e._v("required: false")]),e._v(" "),a("li",[e._v("parameter type: query")]),e._v(" "),a("li",[e._v("data type: object")])])])])]),e._v(" "),a("li",[a("p",[e._v("outcome")]),e._v(" "),a("p",[e._v("For admin request, a list of config items matching the filter; forbidden for user request")])]),e._v(" "),a("li",[a("p",[e._v("example")]),e._v(" "),a("p",[e._v("to retrieve config items with name "),a("em",[e._v("rsa")]),e._v(", run")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -X GET --header "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Accept: application/json'")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'http://localhost:3000/api/configurations?filter=%7B%22where%22%3A%20%7B%22name%22%3A%22rsa%22%7D%7D'")]),e._v("\n")])])]),a("p",[e._v("the value of filter query parameter is the "),a("a",{attrs:{href:"https://loopback.io/doc/en/lb4/Querying-data.html#using-stringified-json-in-rest-queries",target:"_blank",rel:"noopener noreferrer"}},[e._v("stringified JSON"),a("OutboundLink")],1)]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"where"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rsa"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])]),e._v(" "),a("h2",{attrs:{id:"create-a-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-configuration"}},[e._v("#")]),e._v(" Create a Configuration")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("POST /configurations\n")])])]),a("ul",[a("li",[a("p",[e._v("permissions required, one of")]),e._v(" "),a("ul",[a("li",[e._v("super admin")]),e._v(" "),a("li",[e._v("admin")])])]),e._v(" "),a("li",[a("p",[e._v("inputs")]),e._v(" "),a("ul",[a("li",[e._v("an object containing configuration data model fields. At a minimum all required fields that don't have a default value must be supplied. Id field should be omitted since it's auto-generated. The API explorer only created an empty object for field "),a("em",[e._v("value")]),e._v(" but you should populate the child fields.\n"),a("ul",[a("li",[e._v("parameter name: data")]),e._v(" "),a("li",[e._v("required: true")]),e._v(" "),a("li",[e._v("parameter type: body")]),e._v(" "),a("li",[e._v("data type: object")])])])])]),e._v(" "),a("li",[a("p",[e._v("outcome")]),e._v(" "),a("p",[a("em",[e._v("NotifyBC")]),e._v(" performs following actions in sequence")]),e._v(" "),a("ol",[a("li",[e._v("if itâ€™s a user request, error is returned")]),e._v(" "),a("li",[e._v("inputs are validated. For example, required fields without default values must be populated. If validation fails, error is returned")]),e._v(" "),a("li",[e._v("if config item is "),a("em",[e._v("notification")]),e._v(" with field "),a("em",[e._v("value.rss")]),e._v(" populated, and if the field "),a("em",[e._v("value.httpHost")]),e._v(" is missing, it is generated using this request's HTTP protocol , host name and port.")]),e._v(" "),a("li",[e._v("item is saved to database")])])])]),e._v(" "),a("ul",[a("li",[a("p",[e._v("example")]),e._v(" "),a("p",[e._v("see the cURL command on how to create a "),a("RouterLink",{attrs:{to:"/docs/configuration/#subscription-confirmation-request-template"}},[e._v("Subscription Confirmation Request Template")])],1)])]),e._v(" "),a("h2",{attrs:{id:"update-a-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#update-a-configuration"}},[e._v("#")]),e._v(" Update a Configuration")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PATCH /configurations/{id}\n")])])]),a("ul",[a("li",[a("p",[e._v("permissions required, one of")]),e._v(" "),a("ul",[a("li",[e._v("super admin")]),e._v(" "),a("li",[e._v("admin")])])]),e._v(" "),a("li",[a("p",[e._v("inputs")]),e._v(" "),a("ul",[a("li",[e._v("configuration id\n"),a("ul",[a("li",[e._v("parameter name: id")]),e._v(" "),a("li",[e._v("required: true")]),e._v(" "),a("li",[e._v("parameter type: path")]),e._v(" "),a("li",[e._v("data type: string")])])]),e._v(" "),a("li",[e._v("an object containing fields to be updated.\n"),a("ul",[a("li",[e._v("parameter name: data")]),e._v(" "),a("li",[e._v("required: true")]),e._v(" "),a("li",[e._v("parameter type: body")]),e._v(" "),a("li",[e._v("data type: object")])])])])]),e._v(" "),a("li",[a("p",[e._v("outcome")]),e._v(" "),a("p",[e._v("Similar to "),a("em",[e._v("POST")]),e._v(" except field "),a("em",[e._v("update")]),e._v(" is always updated with current timestamp.")])])]),e._v(" "),a("h2",{attrs:{id:"delete-a-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#delete-a-configuration"}},[e._v("#")]),e._v(" Delete a Configuration")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("DELETE /configurations/{id}\n")])])]),a("ul",[a("li",[a("p",[e._v("permissions required, one of")]),e._v(" "),a("ul",[a("li",[e._v("super admin")]),e._v(" "),a("li",[e._v("admin")])])]),e._v(" "),a("li",[a("p",[e._v("inputs")]),e._v(" "),a("ul",[a("li",[e._v("configuration id\n"),a("ul",[a("li",[e._v("parameter name: id")]),e._v(" "),a("li",[e._v("required: true")]),e._v(" "),a("li",[e._v("parameter type: path")]),e._v(" "),a("li",[e._v("data type: string")])])])])]),e._v(" "),a("li",[a("p",[e._v("outcome")]),e._v(" "),a("p",[e._v("For admin request, delete the config item requested; forbidden for user request")])])]),e._v(" "),a("h2",{attrs:{id:"replace-a-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#replace-a-configuration"}},[e._v("#")]),e._v(" Replace a Configuration")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("PUT /configurations/{id}\n")])])]),a("p",[e._v("This API is intended to be only used by admin web console to modify a configuration.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("permissions required, one of")]),e._v(" "),a("ul",[a("li",[e._v("super admin")]),e._v(" "),a("li",[e._v("admin")])])]),e._v(" "),a("li",[a("p",[e._v("inputs")]),e._v(" "),a("ul",[a("li",[e._v("configuration id\n"),a("ul",[a("li",[e._v("parameter name: id")]),e._v(" "),a("li",[e._v("required: true")]),e._v(" "),a("li",[e._v("parameter type: path")]),e._v(" "),a("li",[e._v("data type: string")])])]),e._v(" "),a("li",[e._v("configuration data\n"),a("ul",[a("li",[e._v("parameter name: data")]),e._v(" "),a("li",[e._v("required: true")]),e._v(" "),a("li",[e._v("parameter type: body")]),e._v(" "),a("li",[e._v("data type: object")])])])])]),e._v(" "),a("li",[a("p",[e._v("outcome")]),e._v(" "),a("p",[e._v("For admin requests, replace configuration identified by "),a("em",[e._v("id")]),e._v(" with parameter "),a("em",[e._v("data")]),e._v(" and save to database.")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);