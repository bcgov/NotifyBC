(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{426:function(e,t,s){"use strict";s.r(t);var r=s(42),n=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"reverse-proxy-ip-lists"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reverse-proxy-ip-lists"}},[e._v("#")]),e._v(" Reverse Proxy IP Lists")]),e._v(" "),s("p",[e._v("SiteMinder, being a gateway approached SSO solution, expects the backend HTTP access point of the web sites it protests to be firewall restricted, otherwise the SiteMinder injected HTTP headers can be easily spoofed. However, the restriction cannot be easily implemented on PAAS such as OpenShift. To mitigate, two configuration objects are introduced to create an application-level firewall, both are arrays of ip addresses in the format of "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Dot-decimal_notation",target:"_blank",rel:"noopener noreferrer"}},[e._v("dot-decimal"),s("OutboundLink")],1),e._v(" or "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation",target:"_blank",rel:"noopener noreferrer"}},[e._v("CIDR"),s("OutboundLink")],1),e._v(" notation")]),e._v(" "),s("ul",[s("li",[s("em",[e._v("siteMinderReverseProxyIps")]),e._v(" contains a list of ips or ranges of SiteMinder Web Agents. If set, then the SiteMinder HTTP headers are trusted only if the request is routed from the listed nodes.")]),e._v(" "),s("li",[s("em",[e._v("trustedReverseProxyIps")]),e._v(" contains a list of ips or ranges of trusted reverse proxies between the SiteMinder Web Agents and "),s("em",[e._v("NotifyBC")]),e._v(" application. When running on OpenShift, this is usually the OpenShift router. Express.js "),s("a",{attrs:{href:"https://expressjs.com/en/guide/behind-proxies.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("trust proxy"),s("OutboundLink")],1),e._v(" is set to this config object.")])]),e._v(" "),s("p",[e._v("By default "),s("em",[e._v("trustedReverseProxyIps")]),e._v(" is empty and "),s("em",[e._v("siteMinderReverseProxyIps")]),e._v(" contains only localhost as defined in "),s("em",[e._v("/src/config.ts")])]),e._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("module")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  siteMinderReverseProxyIps"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'127.0.0.1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("To modify, add following objects to file /src/config.local.js")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  siteMinderReverseProxyIps"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'130.32.12.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  trustedReverseProxyIps"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'172.17.0.0/16'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("The rule to determine if the incoming request is authenticated by SiteMinder is")]),e._v(" "),s("ol",[s("li",[e._v("obtain the real client ip address by filtering out trusted proxy ips according to "),s("a",{attrs:{href:"https://expressjs.com/en/guide/behind-proxies.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Express behind proxies"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("if the real client ip is contained in "),s("em",[e._v("siteMinderReverseProxyIps")]),e._v(", then the request is from SiteMinder, and its SiteMinder headers are trusted; otherwise, the request is considered as directly from internet, and its SiteMinder headers are ignored.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);