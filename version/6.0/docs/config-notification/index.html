<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" type="image/x-icon" href="/NotifyBC/version/6.0/favicon.ico"><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title>Notification | NotifyBC</title><meta name="description" content="A versatile notification API server">
    <link rel="preload" href="/NotifyBC/version/6.0/assets/style-BwJoByYn.css" as="style"><link rel="stylesheet" href="/NotifyBC/version/6.0/assets/style-BwJoByYn.css">
    <link rel="modulepreload" href="/NotifyBC/version/6.0/assets/app-uYQXuGBg.js"><link rel="modulepreload" href="/NotifyBC/version/6.0/assets/index.html-CwaFweO8.js">
    <link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-B7T6MiHV.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DHG5nGMT.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-B6hoq2ar.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-Dop1TKia.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CVxpZMfi.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-ClgLQNWW.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-bhWnZDTj.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-ByWvQtNg.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-D634Rrqc.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CcvBhsKk.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-scUF65lU.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BbV85TP9.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-RTcmD1l1.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-C9oLNDYW.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DHqBp6oz.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-Dy3c4sng.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-D5UTgR-8.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-duzgL8eJ.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BW24Z-a_.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DIzhPa6v.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BFAVHqW8.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-Bl98OE5i.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CAVHoefG.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BV6lkj1o.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DddxQWkN.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-C6ha29ZJ.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-QEbjiL45.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BuTUPi-e.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DcSB2gD6.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BNVGPeLr.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-XGoxAhmu.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-BeWUrF6W.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DdIz713k.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CIcke7C0.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CgGquuie.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-Bl1vmTPG.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CNTCYW3Y.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-6glTOBlO.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-CWIY3qCf.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DQgaYXBi.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index.html-DP4dL0vF.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/filterQueryParam.html-D4xZ7QuC.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/filterQueryParamCode.html-HFAE9zs5.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/filterQueryParamExample.html-chuLlaS5.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/jmespathFilter.html-CCIrVdIB.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/whereQueryParam.html-CRsSDXUN.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/whereQueryParamCode.html-B9n0AaqN.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/whereQueryParamExample.html-BzfyHdgN.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/404.html-BfeorJo1.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/index-DjpUunl4.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/mermaid.esm.min-3XlF9jW3.js" as="script"><link rel="prefetch" href="/NotifyBC/version/6.0/assets/setupDevtools-7MC2TMWH-C4EBHGmm.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><!--[--><a class="route-link" href="/NotifyBC/version/6.0/"><img class="vp-site-logo" src="/NotifyBC/version/6.0/img/logo.svg" alt="NotifyBC"></a><!----><!--]--></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/NotifyBC/version/6.0/" aria-label="Home"><!---->Home<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/NotifyBC/version/6.0/docs/" aria-label="Docs"><!---->Docs<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/NotifyBC/version/6.0/help/" aria-label="Help"><!---->Help<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/bcgov/notifybc" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/NotifyBC/version/6.0/" aria-label="Home"><!---->Home<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/NotifyBC/version/6.0/docs/" aria-label="Docs"><!---->Docs<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/NotifyBC/version/6.0/help/" aria-label="Help"><!---->Help<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/bcgov/notifybc" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Getting Started <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/" aria-label="Welcome"><!---->Welcome<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/overview/" aria-label="Overview"><!---->Overview<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/quickstart/" aria-label="Quick Start"><!---->Quick Start<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/installation/" aria-label="Installation"><!---->Installation<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/web-console/" aria-label="Web Console"><!---->Web Console<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/what&#39;s-new/" aria-label="What&#39;s New"><!---->What&#39;s New<!----></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Configuration <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-overview/" aria-label="Configuration Overview"><!---->Configuration Overview<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-database/" aria-label="Database"><!---->Database<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-adminIpList/" aria-label="Admin IP List"><!---->Admin IP List<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-reverseProxyIpLists/" aria-label="Reverse Proxy IP Lists"><!---->Reverse Proxy IP Lists<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-httpHost/" aria-label="HTTP Host"><!---->HTTP Host<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-internalHttpHost/" aria-label="Internal HTTP Host"><!---->Internal HTTP Host<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-email/" aria-label="Email"><!---->Email<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-sms/" aria-label="SMS"><!---->SMS<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-subscription/" aria-label="Subscription"><!---->Subscription<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/NotifyBC/version/6.0/docs/config-notification/" aria-label="Notification"><!---->Notification<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-nodeRoles/" aria-label="Node Roles"><!---->Node Roles<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-cronJobs/" aria-label="Cron Jobs"><!---->Cron Jobs<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-rsaKeys/" aria-label="RSA Keys"><!---->RSA Keys<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-workerProcessCount/" aria-label="Worker Process Count"><!---->Worker Process Count<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-middleware/" aria-label="Middleware"><!---->Middleware<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-oidc/" aria-label="OIDC"><!---->OIDC<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-certificates/" aria-label="TLS Certificates"><!---->TLS Certificates<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-queue/" aria-label="Queue"><!---->Queue<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/config-logging/" aria-label="Logging"><!---->Logging<!----></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">API <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/api-overview/" aria-label="API Overview"><!---->API Overview<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/api-subscription/" aria-label="Subscription"><!---->Subscription<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/api-notification/" aria-label="Notification"><!---->Notification<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/api-config/" aria-label="Configuration"><!---->Configuration<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/api-administrator/" aria-label="Administrator"><!---->Administrator<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/api-bounce/" aria-label="Bounce"><!---->Bounce<!----></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Miscellaneous <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/health-check/" aria-label="Health Check"><!---->Health Check<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/disaster-recovery/" aria-label="Disaster Recovery"><!---->Disaster Recovery<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/memory-dump/" aria-label="Memory Dump"><!---->Memory Dump<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/benchmarks/" aria-label="Benchmarks"><!---->Benchmarks<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/bulk-import/" aria-label="Bulk Import"><!---->Bulk Import<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/developer-notes/" aria-label="Developer Notes"><!---->Developer Notes<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/upgrade/" aria-label="Upgrade Guide"><!---->Upgrade Guide<!----></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Meta <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/conduct/" aria-label="Code of Conduct"><!---->Code of Conduct<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/NotifyBC/version/6.0/docs/acknowledgments/" aria-label="Acknowledgments"><!---->Acknowledgments<!----></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content" vp-content><!--[--><!--]--><div><h1 id="notification" tabindex="-1"><a class="header-anchor" href="#notification"><span>Notification</span></a></h1><p>Configs in this section customize the handling of notification request or generating notifications from RSS feeds. They are all sub-properties of config object <em>notification</em>. Service-agnostic configs are static and service-dependent configs are dynamic.</p><h2 id="rss-feeds" tabindex="-1"><a class="header-anchor" href="#rss-feeds"><span>RSS Feeds</span></a></h2><p><em>NotifyBC</em> can generate broadcast push notifications automatically by polling RSS feeds periodically and detect changes by comparing with an internally maintained history list. The polling frequency, RSS url, RSS item change detection criteria, and message template can be defined in dynamic configs.</p><div class="hint-container caution"><p class="hint-container-title">Only first page is retrieved for paginated RSS feeds</p><p>If a RSS feed is paginated, <i>NotifyBC</i> only retrieves the first page rather than auto-fetch subsequent pages. Hence paginated RSS feeds should be sorted descendingly by last modified timestamp. Refresh interval should be adjusted small enough such that all new or updated items are contained in first page.</p></div><p>For example, to notify subscribers of <em>myService</em> on updates to feed <em>http://my-serivce/rss</em>, create following config item using <a class="route-link" href="/NotifyBC/version/6.0/docs/api-config/#create-a-configuration">POST configuration API</a></p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;notification&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;serviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myService&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;rss&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://my-serivce/rss&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;timeSpec&quot;</span><span class="token operator">:</span> <span class="token string">&quot;* * * * *&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;itemKeyField&quot;</span><span class="token operator">:</span> <span class="token string">&quot;guid&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;outdatedItemRetentionGenerations&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;includeUpdatedItems&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;fieldsToCheckForUpdate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pubDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;description&quot;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;httpHost&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;messageTemplates&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;no_reply@invlid.local&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token property">&quot;subject&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{title}&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token property">&quot;textBody&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{description}&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token property">&quot;htmlBody&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{description}&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;sms&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token property">&quot;textBody&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{description}&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The config items in the <em>value</em> field are</p><ul><li>rss <ul><li>url: RSS url</li><li><a name="timeSpec"></a>timeSpec: RSS poll frequency, a space separated fields conformed to <a href="https://www.freebsd.org/cgi/man.cgi?crontab(5)" target="_blank" rel="noopener noreferrer">unix crontab format</a> with an optional left-most seconds field. See <a href="https://github.com/kelektiv/node-cron#cron-ranges" target="_blank" rel="noopener noreferrer">allowed ranges</a> of each field</li><li>itemKeyField: rss item&#39;s unique key field to identify new items. By default <em>guid</em></li><li>outdatedItemRetentionGenerations: number of last consecutive polls from which results an item has to be absent before the item can be removed from the history list. This config is designed to prevent multiple notifications triggered by the same item because RSS poll returns inconsistent results, usually due to a combination of pagination and lack of sorting. By default 1, meaning the history list only keeps the last poll result</li><li>includeUpdatedItems: whether to notify also updated items or just new items. By default <em>false</em></li><li>fieldsToCheckForUpdate: list of fields to check for updates if <em>includeUpdatedItems</em> is <em>true</em>. By default <em>[&quot;pubDate&quot;]</em></li></ul></li><li>httpHost: the http protocol, host and port used by <a class="route-link" href="/NotifyBC/version/6.0/docs/overview/#mail-merge">mail merge</a>. If missing, the value is auto-populated based on the REST request that creates this config item.</li><li>messageTemplates: channel-specific message templates with channel name as the key. <em>NotifyBC</em> generates a notification for each channel specified in the message templates. Message template fields are the same as those in <a class="route-link" href="/NotifyBC/version/6.0/docs/api-notification/#field-message">notification api</a>. Message template fields support dynamic token.</li></ul><h2 id="broadcast-push-notification-task-concurrency" tabindex="-1"><a class="header-anchor" href="#broadcast-push-notification-task-concurrency"><span>Broadcast Push Notification Task Concurrency</span></a></h2><p>To achieve horizontal scaling, when a broadcast push notification request is received, <em>NotifyBC</em> divides subscribers into chunks and submits a BullMQ job for each chunk. The chunk size is defined by config <em>broadcastSubscriberChunkSize</em>. All subscribers in a chunk are processed concurrently.</p><p>The default value for <em>broadcastSubscriberChunkSize</em> is defined in <em>/src/config.ts</em></p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  notification<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    broadcastSubscriberChunkSize<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To customize, create the config with updated value in file <em>/src/config.local.js</em>.</p><div class="hint-container tip"><p class="hint-container-title">When to adjust chunk size?</p><p>Redis memory footprint is inversely proportional to chunk size. Increase chunk size if Redis memory usage is approaching physical limit.</p></div><h2 id="broadcast-push-notification-custom-filter-functions" tabindex="-1"><a class="header-anchor" href="#broadcast-push-notification-custom-filter-functions"><span>Broadcast Push Notification Custom Filter Functions</span></a></h2><div class="hint-container warning"><p class="hint-container-title">Advanced Topic</p><p>Defining custom function requires knowledge of JavaScript and understanding how external libraries are added and referenced in Node.js. Setting a development environment to test the custom function is also recommended.</p></div><p>To support rule-based notification event filtering, <em>NotifyBC</em> uses a <a href="https://github.com/f-w/jmespath.js" target="_blank" rel="noopener noreferrer">modified version</a> of <a href="http://jmespath.org/" target="_blank" rel="noopener noreferrer">jmespath</a> to implement json query. The modified version allows defining custom functions that can be used in <a href="../api-subscription#broadcastPushNotificationFilter">broadcastPushNotificationFilter</a> field of subscription API and <a href="../api-notification#broadcastPushNotificationSubscriptionFilter">broadcastPushNotificationSubscriptionFilter</a> field of subscription API. The functions must be implemented using JavaScript in config <em>notification.broadcastCustomFilterFunctions</em>. The functions can even be <em>async</em>. For example, the case-insensitive string matching function <em>contains_ci</em> shown in the example of that field can be created in file <em>/src/config.local.js</em></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> _ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;lodash&#39;</span><span class="token punctuation">)</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token literal-property property">notification</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">broadcastCustomFilterFunctions</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">contains_ci</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function-variable function">_func</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolvedArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resolvedArgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token operator">!</span>resolvedArgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">          <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">toLower</span><span class="token punctuation">(</span>resolvedArgs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">toLower</span><span class="token punctuation">(</span>resolvedArgs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">_signature</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">          <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">          <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Consult jmespath.js source code on the <a href="https://github.com/f-w/jmespath.js/blob/master/jmespath.js#L1127" target="_blank" rel="noopener noreferrer">functionTable syntax</a> and <a href="https://github.com/f-w/jmespath.js/blob/master/jmespath.js#L132" target="_blank" rel="noopener noreferrer">type constants</a> used by above code. Note the function can use any Node.js modules (<em><a href="https://lodash.com/" target="_blank" rel="noopener noreferrer">lodash</a></em> in this case).</p><div class="hint-container tip"><p class="hint-container-title">install additional Node.js modules</p><p>The recommended way to install additional Node.js modules is by running command <i><a href="https://docs.npmjs.com/cli/install">npm install &lt;your_module&gt;</a></i> from the directory one level above <i>NotifyBC</i> root. For example, if <i>NotifyBC</i> is installed on <i>/data/notifyBC</i>, then run the command from directory <i>/data</i>. The command will then install the module to <i>/data/node_modules/&lt;your_module&gt;</i>.</p></div><h2 id="guaranteed-broadcast-push-dispatch-processing" tabindex="-1"><a class="header-anchor" href="#guaranteed-broadcast-push-dispatch-processing"><span>Guaranteed Broadcast Push Dispatch Processing</span></a></h2><p>As a major enhancement in v3, by default <em>NotifyBC</em> guarantees all subscribers of a broadcast push notification will be processed in spite of node failures during dispatching. Node failure is a concern because the time takes to dispatch broadcast push notification is proportional to number of subscribers, which is potentially large.</p><p><em>NotifyBC</em> is not only resilient to failures of <em>NotifyBC</em> application nodes, but also entire <em>Redis</em> cluster.</p><p>The guarantee is achieved by</p><ol><li>logging the dispatch result to database individually right after each dispatch</li><li>when subscribers are divided into chunks and a chunk job fails, the job is re-processed by BullMQ</li><li>a chunk job periodically updates the notification <em>updated</em> timestamp field as heartbeat</li><li>if redis cluster fails, a cron job detects the failure from the stale timestamp, and re-submits the notification request</li></ol><p>Guaranteed processing doesn&#39;t mean notification will be dispatched to every intended subscriber, however. Dispatch can still be rejected by smtp/sms server. Furthermore, even if dispatch is successful, it only means the sending is successful. It doesn&#39;t guarantee the recipient receives the notification. <a class="route-link" href="/NotifyBC/version/6.0/docs/config-email/#bounce">Bounce</a> may occur for a successful dispatch, for instance; or the recipient may not read the message.</p><p>The guarantee comes at a performance penalty because result of each dispatch is written to database one by one, taking a toll on the database. It should be noted that the <a class="route-link" href="/NotifyBC/version/6.0/docs/benchmarks/">benchmarks</a> were conducted without the guarantee.</p><p>If performance is a higher priority to you, disable both the guarantee and bounce handling by setting config <em>notification.guaranteedBroadcastPushDispatchProcessing</em> and <em>email.bounce.enabled</em> to <em>false</em> in file <em>/src/config.local.js</em></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">notification</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">guaranteedBroadcastPushDispatchProcessing</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">bounce</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">enabled</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In such case only failed dispatches are written to <em>dispatch.failed</em> field of the notification.</p><h3 id="also-log-skipped-dispatches-for-broadcast-push-notifications" tabindex="-1"><a class="header-anchor" href="#also-log-skipped-dispatches-for-broadcast-push-notifications"><span>Also log skipped dispatches for broadcast push notifications</span></a></h3><p>When <em>guaranteedBroadcastPushDispatchProcessing</em> is <em>true</em>, by default only successful and failed dispatches are logged, along with dispatch candidates. Dispatches that are skipped by filters defined at subscription (<em>broadcastPushNotificationFilter</em>) or notification (<em>broadcastPushNotificationSubscriptionFilter</em>) are not logged for performance reason. If you also want skipped dispatches to be logged to <em>dispatch.skipped</em> field of the notification, set <em>logSkippedBroadcastPushDispatches</em> to <em>true</em> in file <em>/src/config.local.js</em></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line">  <span class="token literal-property property">notification</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token operator">...</span></span>
<span class="line">    <span class="token literal-property property">logSkippedBroadcastPushDispatches</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Setting <em>logSkippedBroadcastPushDispatches</em> to <em>true</em> only has effect when <em>guaranteedBroadcastPushDispatchProcessing</em> is <em>true</em>.</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/NotifyBC/version/6.0/docs/config-subscription/" aria-label="Subscription"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>Subscription</span></div></a><a class="route-link auto-link next" href="/NotifyBC/version/6.0/docs/config-nodeRoles/" aria-label="Node Roles"><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span>Node Roles</span></div></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/NotifyBC/version/6.0/assets/app-uYQXuGBg.js" defer></script>
  </body>
</html>
